var Zodiac=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,p(i.key),i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function i(t,e,n){return(e=p(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}function o(t){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},o(t)}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=o(t);if(e){var r=o(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return s(t)}(this,n)}}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},c.apply(this,arguments)}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);u=!0);}catch(t){c=!0,r=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(t,e)||v(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=v(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function p(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}var y=function(){function e(){t(this,e),this.events=[]}return n(e,[{key:"emit",value:function(t){for(var e=this,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t.forEach((function(t){e.filterByName(t).forEach((function(t){t.callback.apply(t,i)}))}))}},{key:"off",value:function(t){var e,n=this,i=d(t);try{var r=function(){var t=e.value;n.events=n.events.filter((function(e){return e.name!==t}))};for(i.s();!(e=i.n()).done;)r()}catch(t){i.e(t)}finally{i.f()}}},{key:"on",value:function(t,e){var n=this;t.forEach((function(t){return n.events.push({name:t,callback:e})}))}},{key:"filterByName",value:function(t){return this.events.filter((function(e){return e.name===t}))}}]),e}(),m=function(){function e(n){var r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t(this,e),i(this,"baseOptions",{autoplay:!0,autoplaySpeed:5e3,classes:{inner:"zodiac-inner",items:"zodiac-item",track:"zodiac-track"},gap:8,itemsPerView:5,pauseOnHover:!0,transitionSpeed:500}),i(this,"mediaQueryLists",[]),i(this,"mediaQueryOptions",{}),this.eventBus=n,Object.assign(this.baseOptions,o),o.mediaQueryOptions)for(var a=o.mediaQueryOptions,s=0,u=Object.entries(a);s<u.length;s++){var c=l(u[s],2),f=c[0],v=c[1];if(v){var h=matchMedia(f);if(this.hasClasses(v.classes))throw new TypeError("The classes property can only be set once.");this.mediaQueryLists.push({mediaQueryList:h,options:v}),h.addEventListener("change",(function(){r.rebuildEffectiveOptions()}))}}this.rebuildEffectiveOptions()}return n(e,[{key:"getEffectiveOptions",value:function(){return this.effectiveOptions}},{key:"hasClasses",value:function(t){return t&&Object.values(t).some((function(t){return t}))}},{key:"rebuildEffectiveOptions",value:function(){this.eventBus.emit(["rebuildEffectiveOptions.before"]);var t,e=Object.assign({},this.baseOptions),n=d(this.mediaQueryLists);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.mediaQueryList.matches&&Object.assign(e,i.options)}}catch(t){n.e(t)}finally{n.f()}this.effectiveOptions=Object.freeze(e),this.eventBus.emit(["rebuildEffectiveOptions.after"])}}]),e}(),g=function(){function e(){t(this,e)}return n(e,[{key:"mount",value:function(t){this.zodiac=t,this.options=this.zodiac.getEffectiveOptions()}}]),e}();function b(e){return function(e){r(a,e);var i=u(a);function a(){return t(this,a),i.apply(this,arguments)}return n(a,[{key:"mount",value:function(t){var e=this;c(o(a.prototype),"mount",this).call(this,t),this.zodiac.getEventBus().on(["rebuildEffectiveOptions.after"],(function(){e.zodiac.getEventBus().emit(["updateEffectiveOptions.before"]),e.options=e.zodiac.getEffectiveOptions(),e.zodiac.getEventBus().emit(["updateEffectiveOptions.after"])}))}}]),a}(e)}var E=function(){function e(){t(this,e)}return n(e,null,[{key:"range",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return f(Array(t).keys()).map((function(t){return t+e}))}},{key:"rangeMap",value:function(t,e,n,i,r){return(t-e)*(r-i)/(n-e)+i}}]),e}();i(E,"focusableSelectors",["* a","* area","* input","* select","* textarea","* button","* iframe","* object","* embed","* *[tabindex]","* *[contenteditable]"]);var k=function(e){r(a,e);var i=u(a);function a(){return t(this,a),i.apply(this,arguments)}return n(a,[{key:"mount",value:function(t){var e=this;c(o(a.prototype),"mount",this).call(this,t),this.abortController=new AbortController,this.start(),this.pauseOnDrag(),this.pauseOnFocus(),this.pauseOnHover(),this.zodiac.getEventBus().on(["updateEffectiveOptions.after"],(function(){e.abortController.abort(),e.abortController=new AbortController,e.stop(),e.start(),e.pauseOnHover()}))}},{key:"pauseOnDrag",value:function(){var t=this;this.zodiac.getEventBus().on(["drag.before"],(function(){t.stop()})),this.zodiac.getEventBus().on(["drag.after"],(function(){t.start()}))}},{key:"pauseOnFocus",value:function(){var t=this,e=E.focusableSelectors.join(", ");this.zodiac.getSliderElement().querySelectorAll(e).forEach((function(e){e.addEventListener("focusin",(function(){return t.stop()})),e.addEventListener("focusout",(function(){return t.start()}))}))}},{key:"pauseOnHover",value:function(){var t=this;if(this.options.pauseOnHover){var e=this.zodiac.getSliderElement();e.addEventListener("mouseenter",(function(){t.stop()}),{signal:this.abortController.signal}),e.addEventListener("mouseleave",(function(){t.start()}),{signal:this.abortController.signal})}}},{key:"start",value:function(){var t=this,e=this.options,n=e.autoplay,i=e.autoplaySpeed;n&&i>0&&(this.stop(),this.interval=setInterval((function(){t.zodiac.getEventBus().emit(["autoplay.before"]),t.zodiac.next(),t.zodiac.getEventBus().emit(["autoplay.after"])}),i))}},{key:"stop",value:function(){clearInterval(this.interval)}}]),a}(g),O=function(e){r(a,e);var i=u(a);function a(){return t(this,a),i.apply(this,arguments)}return n(a,[{key:"mount",value:function(t){c(o(a.prototype),"mount",this).call(this,t),this.setUpControls()}},{key:"setUpControls",value:function(){var t=this,e=this.zodiac.getSliderElement(),n=e.querySelector('[data-zodiac-direction="right"]');n&&n.addEventListener("click",(function(){return t.zodiac.next()}));var i=e.querySelector('[data-zodiac-direction="left"]');i&&i.addEventListener("click",(function(){return t.zodiac.previous()}))}}]),a}(g),z=function(e){r(l,e);var a=u(l);function l(){var e;t(this,l);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return i(s(e=a.call.apply(a,[this].concat(r))),"activeClass","active"),e}return n(l,[{key:"mount",value:function(t){c(o(l.prototype),"mount",this).call(this,t),this.setActiveClass(),this.setAccessibilityAttributes(),this.setInitialItemState(),this.adjustItemStateOnMove()}},{key:"addActiveClassToItem",value:function(t){t.classList.add(this.activeClass)}},{key:"adjustItemStateOnMove",value:function(){var t=this;this.zodiac.getEventBus().on(["move.after","drag.after"],(function(){t.setActiveClass(),t.setAccessibilityAttributes()}))}},{key:"removeActiveClass",value:function(){var t=this;this.zodiac.getItems().forEach((function(e){return e.classList.remove(t.activeClass)}))}},{key:"setAccessibilityAttributes",value:function(){var t=this,e=this.options.itemsPerView,n=this.zodiac.getPosition(),i=E.range(e,n);this.zodiac.getItems().forEach((function(e,n){var r=i.includes(n),o=(!r).toString();e.setAttribute("aria-hidden",o),t.setTabindex(e,r),e.querySelectorAll(E.focusableSelectors.join(", ")).forEach((function(e){t.setTabindex(e,r)}))}))}},{key:"setActiveClass",value:function(){var t=this.zodiac.getPosition(),e=this.zodiac.getItems().item(t);this.removeActiveClass(),this.addActiveClassToItem(e)}},{key:"setInitialItemState",value:function(){this.zodiac.getItems().forEach((function(t,e){t.setAttribute("data-zodiac-item-index",(e+1).toString())}))}},{key:"setTabindex",value:function(t,e){e?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1")}}]),l}(g),S=function(e){r(a,e);var i=u(a);function a(){return t(this,a),i.apply(this,arguments)}return n(a,[{key:"mount",value:function(t){c(o(a.prototype),"mount",this).call(this,t),this.setItemWidth(),this.setTrackWidth(),this.setTrackTransitionDuration(),this.updateTrackOnResize()}},{key:"getSliderItemMargin",value:function(){return this.options.gap/2}},{key:"getSliderWidth",value:function(){var t=this.options.classes.inner;return this.zodiac.getSliderElement().querySelector(".".concat(t)).getBoundingClientRect().width}},{key:"setItemWidth",value:function(){var t=this,e=this.options.itemsPerView;this.zodiac.setItemWidth(this.getSliderWidth()/e);var n=this.getSliderItemMargin();this.zodiac.getItems().forEach((function(e){e.style.width="".concat(t.zodiac.getItemWidth()-2*n,"px"),e.style.marginLeft="".concat(n,"px"),e.style.marginRight="".concat(n,"px")}))}},{key:"setTrackTransitionDuration",value:function(){var t=this.options.transitionSpeed;this.zodiac.getTrackElement().style.transitionDuration="".concat(t,"ms")}},{key:"setTrackWidth",value:function(){var t=this.zodiac.getItemWidth()*this.zodiac.getItems().length;this.zodiac.getTrackElement().style.width="".concat(t,"px")}},{key:"updateTrackOnResize",value:function(){var t=this;this.zodiac.getEventBus().on(["updateEffectiveOptions.after"],(function(){t.zodiac.getEventBus().emit(["trackUpdated.before"]),t.setItemWidth(),t.setTrackWidth(),t.setTrackTransitionDuration(),t.zodiac.getEventBus().emit(["trackUpdated.after"])}))}}]),a}(g),w=function(e){r(l,e);var a=u(l);function l(){var e;t(this,l);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return i(s(e=a.call.apply(a,[this].concat(r))),"draggingClass","dragging"),i(s(e),"dragPosition",0),i(s(e),"moveController",null),i(s(e),"moveEventKeys",["mousemove","touchmove"]),i(s(e),"preventClick",!1),i(s(e),"snapPosition",0),i(s(e),"startEventKeys",["mousedown","touchstart"]),i(s(e),"startingEventPosition",0),i(s(e),"stopController",null),i(s(e),"stopEventKeys",["mouseup","mouseleave","touchend","touchcancel"]),i(s(e),"threshold",20),e}return n(l,[{key:"mount",value:function(t){c(o(l.prototype),"mount",this).call(this,t),this.addStartEvents(),this.onDragEvents(),this.preventDefaultOnDragStart(),this.preventDefaultClickOnDragStart()}},{key:"addMoveEvents",value:function(){var t=this;this.moveController=new AbortController,this.moveEventKeys.forEach((function(e){t.zodiac.getTrackElement().addEventListener(e,(function(e){return t.move(e)}),{signal:t.moveController.signal})}))}},{key:"addStartEvents",value:function(){var t=this;this.startEventKeys.forEach((function(e){t.zodiac.getTrackElement().addEventListener(e,(function(e){return t.start(e)}))}))}},{key:"addStopEvents",value:function(){var t=this;this.stopController=new AbortController,this.stopEventKeys.forEach((function(e){t.zodiac.getTrackElement().addEventListener(e,(function(){return t.stop()}),{signal:t.stopController.signal})}))}},{key:"getScreenX",value:function(t){var e;return t instanceof TouchEvent?null!==(e=t.touches[0].screenX)&&void 0!==e?e:0:t.screenX}},{key:"getSnapPosition",value:function(t){var e=-Math.round(t/this.zodiac.getItemWidth()),n=this.zodiac.getItemTotal();return e>n&&(e=0),e<0&&(e=n),e}},{key:"modifyLinks",value:function(t){var e=this.zodiac.getTrackElement().querySelectorAll("a");this.preventClick===t&&(e.forEach((function(e){var n=t?"data-href":"href",i=t?"href":"data-href";e.draggable=t,e.setAttribute(i,e.getAttribute(n)),e.removeAttribute(n)})),this.preventClick=!this.preventClick)}},{key:"move",value:function(t){this.zodiac.getEventBus().emit(["drag.move.before"]);var e=this.getScreenX(t)-this.zodiac.getSliderElement().offsetLeft-this.startingEventPosition;if(!(Math.abs(e)<this.threshold)){var n=E.rangeMap(Math.abs(e),this.threshold,window.innerWidth,1,3),i=this.dragPosition+e*n;t.preventDefault(),this.snapPosition=this.getSnapPosition(i),this.zodiac.getTrackElement().style.transform="translate3d(".concat(i,"px, 0, 0)"),this.zodiac.getEventBus().emit(["drag.move.after"])}}},{key:"onDragEvents",value:function(){var t=this;this.zodiac.getEventBus().on(["drag.before"],(function(){t.zodiac.getTrackElement().classList.add(t.draggingClass)})),this.zodiac.getEventBus().on(["drag.after"],(function(){t.zodiac.getTrackElement().classList.remove(t.draggingClass)}))}},{key:"preventDefaultClickOnDragStart",value:function(){var t=this;this.zodiac.getEventBus().on(["drag.move.before"],(function(){t.modifyLinks(!1)})),this.zodiac.getEventBus().on(["drag.after"],(function(){setTimeout((function(){t.modifyLinks(!0)}),t.options.transitionSpeed)}))}},{key:"preventDefaultOnDragStart",value:function(){this.zodiac.getItems().forEach((function(t){t.addEventListener("dragstart",(function(t){return t.preventDefault()}))}))}},{key:"removeMoveEvents",value:function(){this.moveController.abort()}},{key:"removeStopEvents",value:function(){this.stopController.abort()}},{key:"start",value:function(t){this.zodiac.getEventBus().emit(["drag.before"]),this.dragPosition=-Math.abs(this.zodiac.getPosition()*this.zodiac.getItemWidth()),this.snapPosition=this.getSnapPosition(this.dragPosition),this.startingEventPosition=this.getScreenX(t)-this.zodiac.getSliderElement().offsetLeft,this.addMoveEvents(),this.addStopEvents()}},{key:"stop",value:function(){this.zodiac.setPosition(this.snapPosition),this.zodiac.move(this.snapPosition),this.removeMoveEvents(),this.removeStopEvents(),this.zodiac.getEventBus().emit(["drag.after"])}}]),l}(g),C=function(){function e(n,i){var r=this;t(this,e),this.eventBus=new y,this.selector=n,this.options=new m(this.eventBus,i);var o=this.options.getEffectiveOptions();this.components=this.registerComponents(),this.sliderElement=document.querySelector(this.selector),this.trackElement=this.sliderElement.querySelector(".".concat(o.classes.track)),this.items=this.sliderElement.querySelectorAll(".".concat(o.classes.items)),this.position=0,this.eventBus.on(["trackUpdated.after"],(function(){return r.next(0)}))}return n(e,[{key:"getEffectiveOptions",value:function(){return this.options.getEffectiveOptions()}},{key:"getEventBus",value:function(){return this.eventBus}},{key:"getItemTotal",value:function(){return this.items.length-1}},{key:"getItemWidth",value:function(){return this.itemWidth}},{key:"getItems",value:function(){return this.items}},{key:"getPosition",value:function(){return this.position}},{key:"getSliderElement",value:function(){return this.sliderElement}},{key:"getTrackElement",value:function(){return this.trackElement}},{key:"mount",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=d(this.components.concat(e));try{for(n.s();!(t=n.n()).done;){t.value.mount(this)}}catch(t){n.e(t)}finally{n.f()}return this}},{key:"move",value:function(t){var e=this.getItemWidth()*t*-1;this.trackElement.style.transform="translate3d(".concat(e,"px, 0px, 0px)")}},{key:"next",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.eventBus.emit(["move.before"]);var e=this.getPosition();(e+=t)>this.getItemTotal()&&(e=0),this.move(e),this.setPosition(e),this.eventBus.emit(["move.after"])}},{key:"off",value:function(t){return this.eventBus.off(t),this}},{key:"on",value:function(t,e){return this.eventBus.on(t,e),this}},{key:"previous",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.eventBus.emit(["move.before"]);var e=this.getPosition();(e-=t)<0&&(e=this.getItemTotal()),this.move(e),this.setPosition(e),this.eventBus.emit(["move.after"])}},{key:"setItemWidth",value:function(t){this.itemWidth=t}},{key:"setPosition",value:function(t){if(Number.isNaN(t)||t<0||t>this.getItemTotal())throw new RangeError("Invalid position: ".concat(t));this.position=Math.trunc(t)}},{key:"registerComponents",value:function(){return[z,b(S),b(k),O,b(w)].map((function(t){return new t}))}}]),e}();return C}();
//# sourceMappingURL=zodiac.min.js.map
